<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <title>SimpleShopping</title>
</head>
<body>

<div id="app"></div>

<template id="template_app">
    <v-app>
        <v-container grid-list-md text-xs-center>
            <v-layout row wrap>
                <v-flex xs12>
                    <order-form></order-form>
                </v-flex>
            </v-layout>
        </v-container>
        <v-footer height="auto" color="primary lighten-1">
            <v-layout justify-center row wrap>
                <div>&copy; {{ new Date().getFullYear() }}</div>
            </v-layout>
        </v-footer>
    </v-app>
</template>

<template id="template_order-form">
    <div>

        <v-dialog v-model="dialog.visible" persistent max-width="290">
            <v-card>
                <v-card-title class="headline">Внимание</v-card-title>
                <v-card-text>{{ dialog.text }}</v-card-text>
                <v-card-actions>
                    <v-spacer></v-spacer>
                    <v-btn color="green darken-1" flat @click.native="dialog.visible = false">Закрыть</v-btn>
                </v-card-actions>
            </v-card>
        </v-dialog>

        <v-form @submit.prevent="add()">

            <v-container grid-list-md text-xs-center>
                <v-layout row wrap>
                    <v-flex xs9>
                        <v-text-field v-model.trim="item" label="Товар" outline :counter="100"></v-text-field>
                    </v-flex>
                    <v-flex xs3>
                        <v-btn outline color="indigo" :large="true" type="submit" :disabled="!item.length">Добавить</v-btn>
                    </v-flex>
                </v-layout>
            </v-container>

            <v-list two-line subheader v-if="form.list.length">
                <v-subheader inset>Товары в корзине</v-subheader>

                <v-list-tile
                        v-for="(item, index) in form.list"
                        :key="index"
                        avatar
                        @click=""
                >
                    <v-list-tile-avatar>
                        <v-icon class="grey lighten-1 white--text">shopping_cart</v-icon>
                    </v-list-tile-avatar>

                    <v-list-tile-content>
                        <v-list-tile-title>{{ item }}</v-list-tile-title>
                    </v-list-tile-content>

                    <v-list-tile-action>
                        <v-tooltip bottom>
                            <v-btn flat icon color="red" @click="remove(item)" slot="activator">
                                <v-icon>delete</v-icon>
                            </v-btn>
                            <span>удалить</span>
                        </v-tooltip>
                    </v-list-tile-action>
                </v-list-tile>

            </v-list>

            <h4 v-else>В списке заказов пусто</h4>
        </v-form>

        <v-form v-if="form.list.length">
            <v-container>
                <v-layout row wrap>

                    <v-flex xs12 sm6>
                        <v-text-field v-model="form.first_name" label="Имя" outline></v-text-field>
                    </v-flex>

                    <v-flex xs12 sm6>
                        <v-text-field v-model="form.phone" mask="phone" label="Номер телефона" outline></v-text-field>
                    </v-flex>

                    <v-flex xs12>
                        <v-autocomplete
                                outline
                                v-model="form.delivery_address"
                                :items="items"
                                :loading="isLoading"
                                :search-input.sync="search"
                                hide-selected
                                label="Адрес доставки"
                                placeholder="Начните ввод для поиска"
                                prepend-icon="mdi-database-search"
                                return-object
                                :clearable="true"
                        ></v-autocomplete>
                    </v-flex>

                    <v-flex xs12>
                        <v-textarea
                                v-model="form.comment"
                                outline
                                label="Примечание"
                        ></v-textarea>
                    </v-flex>

                </v-layout>
            </v-container>
            <template>
                <div class="text-xs-center">
                    <v-btn
                            :disabled="loader || !isFormValid()"
                            :loading="loader"
                            outline
                            color="indigo"
                            @click="confirm()"
                    >
                        Подтвердить заказ
                    </v-btn>

                    <v-dialog
                            v-model="loader"
                            hide-overlay
                            persistent
                            width="300"
                    >
                        <v-card color="primary" dark>
                            <v-card-text>
                                Оформления заказа...
                                <v-progress-linear
                                        indeterminate
                                        color="white"
                                        class="mb-0"
                                ></v-progress-linear>
                            </v-card-text>
                        </v-card>
                    </v-dialog>
                </div>
            </template>
        </v-form>

    </div>
</template>

<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.5.1"></script>

<script src="/public/js/app.js"></script>

</body>
</html>